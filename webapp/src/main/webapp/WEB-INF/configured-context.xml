<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:ctx="http://www.springframework.org/schema/context"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
                           http://www.springframework.org/schema/context
                           http://www.springframework.org/schema/context/spring-context-3.2.xsd">

    <bean class="org.n52.iceland.util.activation.ActivationRegistrator">
        <description>Used to wire up activation persistence.</description>
        <property name="listeners">
            <map>
                <entry key-ref="bindingRepository" value="#{activationService.bindingListener}" />
                <entry key-ref="owsExtendedCapabilitiesRepository" value="#{activationService.owsExtendedCapabiltiesListener}"/>
                <entry key-ref="requestOperatorRepository" value="#{activationService.requestOperatorListener}"/>
            </map>
        </property>
        <property name="initializers">
            <map>
                <entry key-ref="bindingRepository" value="#{activationService.bindingInitializer}" />
                <entry key-ref="owsExtendedCapabilitiesRepository" value="#{activationService.owsExtendedCapabiltiesInitializer}"/>
                <entry key-ref="requestOperatorRepository" value="#{activationService.requestOperatorInitializer}" />
            </map>
        </property>
    </bean>

     <bean class="org.n52.iceland.util.activation.ActivationRegistrator">
        <description>Used to wire up SOS specific activation persistence.</description>
        <property name="listeners">
            <map>
                <entry key-ref="offeringExtensionRepository" value="#{sosActivationService.offeringExtensionListener}" />
                <entry key-ref="procedureDescriptionFormatRepository" value="#{sosActivationService.procedureDescriptionFormatListener}"/>
                <entry key-ref="responseFormatRepository" value="#{sosActivationService.responseFormatListener}" />
            </map>
        </property>
        <property name="initializers">
            <map>
                <entry key-ref="offeringExtensionRepository" value="#{sosActivationService.offeringExtensionInitializer}" />
                <entry key-ref="procedureDescriptionFormatRepository" value="#{sosActivationService.procedureDescriptionFormatInitializer}" />
                <entry key-ref="responseFormatRepository" value="#{sosActivationService.responseFormatInitializer}" />
            </map>
        </property>
    </bean>

    <bean id="icelandServlet" class="org.n52.iceland.service.Service" />

    <bean id="configurator" class="org.n52.iceland.service.Configurator" />

    <bean id="serviceProviderFactory" class="org.n52.iceland.ogc.ows.ServiceProviderFactory" />
    <bean id="serviceIdentificationFactory" class="org.n52.iceland.ogc.ows.ServiceIdentificationFactory" />

    <bean class="org.n52.sos.ds.hibernate.values.HibernateStreamingConfiguration" />
    <bean class="org.n52.iceland.service.ServiceConfiguration"/>
    <bean class="org.n52.sos.utils.EXIUtils" />
    <bean class="org.n52.sos.converter.util.EReportingPrefixedIdentifierHelper" />
    <bean class="org.n52.sos.service.ProcedureDescriptionSettings" />
    <bean class="org.n52.sos.aqd.AqdHelper" />
    <bean class="org.n52.sos.service.TransactionalSecurityConfiguration" />
    <bean class="org.n52.sos.inspire.InspireHelper" />
    <bean class="org.n52.sos.binding.rest.Constants" />
    <bean class="org.n52.sos.converter.util.FlexibleIdentifierHelper" />
    <bean class="org.n52.sos.converter.util.PrefixedIdentifierHelper" />

    <bean id="owsExtendedCapabilitiesRepository"
          class="org.n52.iceland.ogc.ows.OwsExtendedCapabilitiesProviderRepository" />
    <bean id="offeringExtensionRepository"
          class="org.n52.iceland.ogc.swes.OfferingExtensionRepository" />
    <bean id="capabilitiesExtensionRepository"
          class="org.n52.iceland.ogc.sos.CapabilitiesExtensionRepository" />


    <bean id="reportObligationRepository"
          class="org.n52.sos.inspire.aqd.ReportObligationRepository" />

    <bean id="reportingHeaderSQLiteManager"
          class="org.n52.sos.inspire.aqd.persistence.ReportingHeaderSQLiteManager">
        <property name="sessionFactory">
            <bean class="org.n52.sos.config.sqlite.SQLiteSessionFactory">
                <property name="databaseName" value="eReportingHeader" />
                <property name="annotatedClasses">
                    <array>
                        <value>org.n52.sos.inspire.aqd.persistence.JSONFragment</value>
                    </array>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="additionalObservationCreatorRepository"
          class="org.n52.sos.ds.hibernate.util.observation.AdditionalObservationCreatorRepository" />
    <bean id="hibernateProcedureDescriptionGeneratorFactoryRepository"
          class="org.n52.sos.ds.hibernate.util.procedure.generator.HibernateProcedureDescriptionGeneratorFactoryRepository" />
    <bean id="geometryHandler" class="org.n52.sos.util.GeometryHandler" />

    <bean id="driverCleanupListener" class="org.n52.sos.service.DriverCleanupListener" />

    <bean id="insertSensorCapabilitiesExtensionProvider"
          class="org.n52.sos.ds.hibernate.InsertSensorCapabilitiesExtensionProvider" />
    <bean id="insertResultCapabiltiesExtensionProvider"
          class="org.n52.sos.ds.hibernate.InsertResultCapabiltiesExtensionProvider" />
    <bean id="insertResultTemplateCapabilitiesExtensionProvider"
          class="org.n52.sos.ds.hibernate.InsertResultTemplateCapabilitiesExtensionProvider" />


    <import resource="components/configured/cache.xml" />
    <import resource="components/configured/events.xml" />
    <import resource="components/configured/bindings.xml" />
    <import resource="components/configured/coding.xml" />
    <import resource="components/configured/converters.xml" />
    <import resource="components/configured/operation-handlers.xml" />
    <import resource="components/configured/request-operators.xml" />
    <import resource="components/configured/request-response-modifiers.xml" />
    <import resource="components/configured/service-operators.xml" />
    <import resource="components/configured/response-writers.xml" />
    <import resource="components/configured/daos.xml" />
    <import resource="components/configured/web.xml" />
    <!--<import resource="components/configured/settings-sqlite.xml" />-->
    <import resource="components/configured/settings-json.xml" />


    <!--
        org.n52.iceland.ogc.ows.OwsExtendedCapabilitiesProvider
    -->

    <!-- OwsExtendedCapabilitiesProvider implementations from extensions/inspire/code -->
    <bean class="org.n52.sos.inspire.capabilities.InspireExtendedCapabilitiesProvider"/>


    <!--
        org.n52.iceland.ogc.swes.OfferingExtensionProvider
    -->

    <!-- OfferingExtensionProvider implementations from extensions/inspire/code -->
    <bean class="org.n52.sos.inspire.offering.InspireOfferingExtensionProvider"/>

    <!--
        org.n52.sos.service.profile.ProfileHandler
    -->

    <!-- ProfileHandler implementations from core/profile/coding -->
    <bean id="profileHandler" class="org.n52.sos.profile.ProfileHandlerImpl" />

</beans>
