<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
    "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
    <class name="org.n52.sos.ds.hibernate.entities.FeatureOfInterest">
        <subselect>
            SELECT 1 AS featureOfInterestId
        </subselect>
        <id name="featureOfInterestId" type="long" />
        <property name="identifier" type="string" insert="false" update="false" formula="'urn:ogc:def:object:feature:FOI_OBSEA'" />
        <property name="name" type="string" insert="false" update="false" formula="'OBSEA'"/>
        <property name="geom" type="org.hibernate.spatial.GeometryType" insert="false" update="false" formula="NULL" />
        <property name="descriptionXml" type="string" insert="false" update="false" formula="NULL"/>
        <property name="url" type="string" insert="false" update="false" formula="NULL"/>
        <property name="longitude" type="double" update="false" insert="false" formula="1.75" />
        <property name="latitude" type="double" update="false" insert="false" formula="41.18" />
        <property name="altitude" type="double" update="false" insert="false" formula="NULL" />
        <property name="srid" type="integer" update="false" insert="false" formula="4326" />
        <many-to-one name="featureOfInterestType" class="org.n52.sos.ds.hibernate.entities.FeatureOfInterestType" fetch="select" lazy="no-proxy" update="false" insert="false" formula="1"/>
        <many-to-one name="codespace" class="org.n52.sos.ds.hibernate.entities.Codespace" fetch="select" lazy="no-proxy" insert="false" update="false" formula="1"/>
    </class>
    <sql-query name="getFeatureOfInterestIdentifiersForOffering">
        <return-scalar column="identifier" type="string" />
        <![CDATA[
        	SELECT
				'urn:ogc:def:object:feature:FOI_OBSEA' AS identifier
			FROM (
				SELECT
			    	:offering AS offering
			) AS offering
			WHERE
				offering.offering = :offering
		]]>
    </sql-query>
    <sql-query name="getFeatureOfInterestIdentifiersForObservationConstellation">
        <return-scalar column="identifier" type="string" />
        <![CDATA[
        	SELECT 'urn:ogc:def:object:feature:FOI_OBSEA' AS identifier 
        	FROM (
        		SELECT
        			:offering AS offering,
        			:procedure AS `procedure`,
        			:observableProperty AS observableProperty
        	) AS observationConstellation
       		WHERE 
	        	observationConstellation.offering = :offering
	        	AND
	        	observationConstellation.procedure = :procedure
	        	AND
	        	observationConstellation.observableProperty = :observableProperty
       ]]>
    </sql-query>
</hibernate-mapping>
